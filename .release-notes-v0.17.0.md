# v0.17.0 - Key Authorization & Monetization

## üéâ Major Features

### Server-Side OpenAI Key Management (Pattern-MONETIZATION-001)
- **Token-based pricing**: 375 tokens = 1 minute of transcription
  - Free tier: 250,000 tokens (~666 minutes one-time)
  - Pro tier: 1,000,000 tokens/month ($29.99/month)
  - Token purchase: 1,000,000 tokens ($24.99 one-time, never expires)

### Desktop App Token Integration
- Token balance display with real-time updates
- Pre-flight checks (requires 375 tokens minimum)
- Server-driven warning system (80%, 90%, 95% thresholds)
- License key activation wizard

### API Endpoints (Production)
- `GET /api/tokens/balance` - Check balance with warnings
- `POST /api/desktop/transcribe` - Server-proxied Whisper API
- `POST /api/tokens/consume` - Token deduction
- `POST /api/stripe/create-checkout` - Payment integration
- Production URL: https://aetherlight-aelors-projects.vercel.app

### Monthly Token Refresh
- Vercel cron job (1st of each month)
- Automatic 1M token refresh for Pro users

## üîÑ Changed

- **Desktop app** now proxies transcription through server API
- **Token balance UI** now server-driven (removed 35 lines of client-side logic)
- **Architecture**: Extension ‚Üí Desktop ‚Üí Server ‚Üí OpenAI

## ‚ùå Removed

- **BYOK (Bring Your Own Key)** model completely removed
- Direct OpenAI API calls deleted from extension
- `transcribeAudioWithWhisper()`, `transcribeAudio()`, `transcribe()` functions removed

## ‚ö†Ô∏è Deprecated Settings

All OpenAI-related settings marked `[DEPRECATED Sprint 4]`:
- `aetherlight.openaiApiKey`
- `aetherlight.terminal.voice.autoTranscribe`
- `aetherlight.terminal.voice.openaiModel`
- `aetherlight.openai.apiKey`
- `aetherlight.desktop.whisperModel`

## üîß Fixed

- RLS blocking license key authentication (service role key)
- Pricing documentation mismatch ($29.99/month)

## üí• Breaking Changes

- **Extension v0.17.0 requires desktop app v0.17.0** (upgrade both together)
- **BYOK model removed** (no more user-provided API keys)
- **License key required** for voice transcription

## üìñ Migration

See [MIGRATION_GUIDE.md](https://github.com/AEtherlight-ai/lumina/blob/master/MIGRATION_GUIDE.md)

**Steps:**
1. Update extension to v0.17.0
2. Update desktop app to v0.17.0
3. Sign up at https://aetherlight.dev/signup
4. Get license key from dashboard
5. Enter key in desktop app wizard (Step 3)
6. Start recording!

## üß™ Test Credentials (Production)

- Free tier: `CD7W-AJDK-RLQT-LUFA` (250,000 tokens)
- Pro tier: `W7HD-X79Q-CQJ9-XW13` (1,000,000 tokens/month)

## üì¶ Installation

Download the VSIX file from this release and install via:
- VS Code: Extensions ‚Üí Install from VSIX...
- Command line: `code --install-extension aetherlight-0.17.0.vsix`

Desktop installers are bundled in the VSIX:
- Windows (NSIS): Lumina_0.1.0_x64-setup.exe
- Windows (MSI): Lumina_0.1.0_x64_en-US.msi

---

**Full Changelog**: https://github.com/AEtherlight-ai/lumina/blob/master/CHANGELOG.md#0170

ü§ñ Generated with [Claude Code](https://claude.com/claude-code)
